# âš™ï¸ FR-001: í˜„ì¬ ìœ„ì¹˜ ë‚ ì”¨ ì¡°íšŒ

## ğŸ“‹ ë¬¸ì„œ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ê¸°ëŠ¥ ID** | FR-001 |
| **ë²„ì „** | 1.0 |
| **ì‘ì„±ì¼** | 2024ë…„ 12ì›” 4ì¼ |
| **ìš°ì„ ìˆœìœ„** | ğŸ”´ í•„ìˆ˜ |
| **ì˜ˆìƒ ê³µìˆ˜** | 3ì¼ |
| **ìƒíƒœ** | ğŸ“ ì‘ì„±ì™„ë£Œ |

---

## ğŸ¯ ê¸°ëŠ¥ ê°œìš”

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ê¸°ëŠ¥ëª…** | í˜„ì¬ ìœ„ì¹˜ ë‚ ì”¨ ì¡°íšŒ |
| **ì„¤ëª…** | ì‚¬ìš©ìì˜ í˜„ì¬ ìœ„ì¹˜ ë˜ëŠ” ì„ íƒí•œ ìœ„ì¹˜ì˜ ì‹¤ì‹œê°„ ë‚ ì”¨ ì •ë³´ë¥¼ ì¡°íšŒí•˜ì—¬ í™”ë©´ì— í‘œì‹œ |
| **ì…ë ¥** | ìœ„ì¹˜ ì •ë³´ (ìœ„ë„/ê²½ë„) |
| **ì¶œë ¥** | í˜„ì¬ ê¸°ì˜¨, ì²´ê°ì˜¨ë„, ìŠµë„, ë‚ ì”¨ ìƒíƒœ, ë‚ ì”¨ ì•„ì´ì½˜ |

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

| ë¬¸ì„œ | ì—­í•  |
|------|------|
| [US-001](../user-stories/US-001.md) | ê´€ë ¨ ì‚¬ìš©ì ìŠ¤í† ë¦¬ |
| [US-002](../user-stories/US-002.md) | ê´€ë ¨ ì‚¬ìš©ì ìŠ¤í† ë¦¬ |
| [FR-005](./FR-005.md) | ì„ í–‰ ê¸°ëŠ¥ (ìœ„ì¹˜ ì„¤ì •) |
| [FR-002](./FR-002.md) | í›„í–‰ ê¸°ëŠ¥ (ìŒì‹ ì¶”ì²œ) |
| [open_weather_api.md](../../api_docs/open_weather_api.md) | API ë¬¸ì„œ |
| [design_system.md](../../design_system.md) | UI ë””ìì¸ ê°€ì´ë“œ |
| [DEVELOPMENT_GUIDE.md](../../DEVELOPMENT_GUIDE.md) | ê°œë°œ ê°€ì´ë“œ |

---

## ğŸ“¡ API ì—°ë™ ëª…ì„¸

### OpenWeatherMap Current Weather API

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì—”ë“œí¬ì¸íŠ¸** | `https://api.openweathermap.org/data/2.5/weather` |
| **ë©”ì„œë“œ** | GET |
| **ì¸ì¦** | API Key (query parameter) |

### ìš”ì²­ íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | í•„ìˆ˜ | íƒ€ì… | ì„¤ëª… |
|---------|------|------|------|
| `lat` | âœ… | number | ìœ„ë„ |
| `lon` | âœ… | number | ê²½ë„ |
| `appid` | âœ… | string | API í‚¤ |
| `units` | â¬œ | string | `metric` (ì„­ì”¨) |
| `lang` | â¬œ | string | `ko` (í•œêµ­ì–´) |

### ìš”ì²­ ì˜ˆì‹œ

```typescript
// services/weather/weatherService.ts
const response = await apiClient.get(
  'https://api.openweathermap.org/data/2.5/weather',
  {
    params: {
      lat: 37.5665,
      lon: 126.9780,
      appid: env.OPENWEATHER_API_KEY,
      units: 'metric',
      lang: 'ko',
    },
  }
);
```

### ì‘ë‹µ ë°ì´í„° (í™œìš© í•„ë“œ)

```typescript
interface WeatherAPIResponse {
  coord: {
    lon: number;
    lat: number;
  };
  weather: Array<{
    id: number;
    main: string;        // "Clear", "Rain", "Clouds" ë“±
    description: string; // "ë§‘ìŒ", "ê°€ë²¼ìš´ ë¹„" ë“± (í•œêµ­ì–´)
    icon: string;        // "01d", "10n" ë“±
  }>;
  main: {
    temp: number;        // í˜„ì¬ ê¸°ì˜¨ (Â°C)
    feels_like: number;  // ì²´ê° ì˜¨ë„ (Â°C)
    humidity: number;    // ìŠµë„ (%)
    pressure: number;    // ê¸°ì•• (hPa)
  };
  visibility: number;    // ê°€ì‹œê±°ë¦¬ (m)
  wind: {
    speed: number;       // í’ì† (m/s)
    deg: number;         // í’í–¥ (ë„)
  };
  name: string;          // ë„ì‹œëª…
  sys: {
    country: string;     // êµ­ê°€ ì½”ë“œ
  };
  dt: number;            // ë°ì´í„° ì‹œê°„ (Unix timestamp)
  timezone: number;      // íƒ€ì„ì¡´ ì˜¤í”„ì…‹ (ì´ˆ)
}
```

---

## ğŸ—‚ï¸ ë°ì´í„° ëª¨ë¸

### WeatherInfo íƒ€ì…

```typescript
// types/weather.ts
export interface WeatherInfo {
  location: {
    name: string;      // ë„ì‹œëª…
    lat: number;       // ìœ„ë„
    lon: number;       // ê²½ë„
    country: string;   // êµ­ê°€ ì½”ë“œ
  };
  current: {
    temp: number;      // í˜„ì¬ ê¸°ì˜¨
    feelsLike: number; // ì²´ê° ì˜¨ë„
    humidity: number;  // ìŠµë„
    pressure: number;  // ê¸°ì••
    visibility: number;// ê°€ì‹œê±°ë¦¬
    windSpeed: number; // í’ì†
    windDeg: number;   // í’í–¥
  };
  weather: {
    id: number;        // ë‚ ì”¨ ìƒíƒœ ID
    main: string;      // ë‚ ì”¨ ìƒíƒœ (Clear, Rain ë“±)
    description: string; // ìƒì„¸ ì„¤ëª…
    icon: string;      // ì•„ì´ì½˜ ì½”ë“œ
  };
  timestamp: number;   // ë°ì´í„° ì‹œê°„
  timezone: number;    // íƒ€ì„ì¡´
}
```

### ì‘ë‹µ ë³€í™˜ í•¨ìˆ˜

```typescript
// services/weather/weatherUtils.ts
export function transformWeatherResponse(data: WeatherAPIResponse): WeatherInfo {
  return {
    location: {
      name: data.name,
      lat: data.coord.lat,
      lon: data.coord.lon,
      country: data.sys.country,
    },
    current: {
      temp: data.main.temp,
      feelsLike: data.main.feels_like,
      humidity: data.main.humidity,
      pressure: data.main.pressure,
      visibility: data.visibility,
      windSpeed: data.wind.speed,
      windDeg: data.wind.deg,
    },
    weather: data.weather[0],
    timestamp: data.dt,
    timezone: data.timezone,
  };
}
```

---

## ğŸ—ï¸ êµ¬í˜„ ëª…ì„¸

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
src/
â”œâ”€â”€ services/
â”‚   â””â”€â”€ weather/
â”‚       â”œâ”€â”€ index.ts           # Public exports
â”‚       â”œâ”€â”€ weatherService.ts  # API í˜¸ì¶œ ë¡œì§
â”‚       â”œâ”€â”€ weatherTypes.ts    # íƒ€ì… ì •ì˜
â”‚       â””â”€â”€ weatherUtils.ts    # ë³€í™˜ í•¨ìˆ˜
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useWeather.ts          # React Query Hook
â”œâ”€â”€ components/
â”‚   â””â”€â”€ weather/
â”‚       â”œâ”€â”€ WeatherDisplay.tsx # ë‚ ì”¨ í‘œì‹œ ì»´í¬ë„ŒíŠ¸
â”‚       â”œâ”€â”€ WeatherCard.tsx    # ë‚ ì”¨ ì¹´ë“œ UI
â”‚       â””â”€â”€ WeatherIcon.tsx    # ë‚ ì”¨ ì•„ì´ì½˜
â””â”€â”€ stores/
    â””â”€â”€ weatherStore.ts        # Zustand ìŠ¤í† ì–´
```

### ì„œë¹„ìŠ¤ ë ˆì´ì–´

```typescript
// services/weather/weatherService.ts
import { apiClient } from '@/configs/api';
import { env } from '@/configs/env';
import type { WeatherInfo, Location } from '@/types/weather';
import { transformWeatherResponse } from './weatherUtils';

export const weatherService = {
  /**
   * í˜„ì¬ ë‚ ì”¨ ì¡°íšŒ
   * @param location - ìœ„ì¹˜ ì •ë³´ (ìœ„ë„/ê²½ë„)
   * @returns ë‚ ì”¨ ì •ë³´
   */
  async getCurrentWeather(location: Location): Promise<WeatherInfo> {
    const response = await apiClient.get(
      'https://api.openweathermap.org/data/2.5/weather',
      {
        params: {
          lat: location.lat,
          lon: location.lon,
          appid: env.OPENWEATHER_API_KEY,
          units: 'metric',
          lang: 'ko',
        },
      }
    );
    return transformWeatherResponse(response.data);
  },
};
```

### React Query Hook

```typescript
// hooks/useWeather.ts
import { useQuery } from '@tanstack/react-query';
import { weatherService } from '@/services/weather';
import type { Location } from '@/types/weather';

export const useWeather = (location: Location | null) => {
  return useQuery({
    queryKey: ['weather', location?.lat, location?.lon],
    queryFn: () => weatherService.getCurrentWeather(location!),
    enabled: !!location,
    staleTime: 5 * 60 * 1000, // 5ë¶„
    gcTime: 10 * 60 * 1000,   // 10ë¶„
    retry: 2,
  });
};
```

### Zustand ìŠ¤í† ì–´

```typescript
// stores/weatherStore.ts
import { create } from 'zustand';
import type { WeatherInfo, Location } from '@/types/weather';

interface WeatherState {
  currentWeather: WeatherInfo | null;
  setCurrentWeather: (weather: WeatherInfo | null) => void;
}

export const useWeatherStore = create<WeatherState>((set) => ({
  currentWeather: null,
  setCurrentWeather: (weather) => set({ currentWeather: weather }),
}));
```

---

## ğŸ¨ UI ì»´í¬ë„ŒíŠ¸ ëª…ì„¸

### WeatherDisplay ì»´í¬ë„ŒíŠ¸

```typescript
// components/weather/WeatherDisplay.tsx
interface WeatherDisplayProps {
  location: Location | null;
}

export const WeatherDisplay = ({ location }: WeatherDisplayProps) => {
  const { data: weather, isLoading, error } = useWeather(location);

  if (isLoading) return <WeatherSkeleton />;
  if (error) return <WeatherError error={error} />;
  if (!weather) return null;

  return <WeatherCard weather={weather} />;
};
```

### WeatherCard ì»´í¬ë„ŒíŠ¸ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ ì„œìš¸ ê°•ë‚¨êµ¬                      â”‚  â† ìœ„ì¹˜ëª…
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚       â˜€ï¸                            â”‚  â† ë‚ ì”¨ ì•„ì´ì½˜ (48px)
â”‚      22Â°C                           â”‚  â† ê¸°ì˜¨ (Display í°íŠ¸)
â”‚  ì²´ê° 24Â°C Â· ë§‘ìŒ                    â”‚  â† ì²´ê°ì˜¨ë„ + ìƒíƒœ
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  ğŸ’§ 45%  ğŸŒ¬ï¸ 3m/s                    â”‚  â† ìŠµë„, í’ì†
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìŠ¤íƒ€ì¼ ì°¸ì¡°

- **ë°°ê²½**: ë‚ ì”¨ë³„ í…Œë§ˆ ê·¸ë¼ë°ì´ì…˜ ([design_system.md ì„¹ì…˜ 2.2](../../design_system.md))
- **ê¸°ì˜¨ í°íŠ¸**: Display (Outfit, 40px, bold)
- **ì•„ì´ì½˜**: 48px, OpenWeatherMap ë˜ëŠ” ì»¤ìŠ¤í…€
- **ì¹´ë“œ**: `shadow-card`, `rounded-lg`

---

## âœ… ì¸ìˆ˜ ì¡°ê±´

| ID | ì¡°ê±´ | í…ŒìŠ¤íŠ¸ ë°©ë²• |
|----|------|-----------|
| AC-1 | ìœ„ì¹˜ ì •ë³´ê°€ ì£¼ì–´ì§€ë©´ 2ì´ˆ ì´ë‚´ì— ë‚ ì”¨ë¥¼ ì¡°íšŒí•œë‹¤ | API ì‘ë‹µ ì‹œê°„ ì¸¡ì • |
| AC-2 | í˜„ì¬ ê¸°ì˜¨ì´ ì†Œìˆ˜ì  ì—†ì´ í‘œì‹œëœë‹¤ | UI í™•ì¸ |
| AC-3 | ì²´ê° ì˜¨ë„ê°€ í‘œì‹œëœë‹¤ | UI í™•ì¸ |
| AC-4 | ë‚ ì”¨ ìƒíƒœê°€ í•œêµ­ì–´ë¡œ í‘œì‹œëœë‹¤ | UI í™•ì¸ |
| AC-5 | ë‚ ì”¨ ì•„ì´ì½˜ì´ ë‚ ì”¨ ìƒíƒœì— ë§ê²Œ í‘œì‹œëœë‹¤ | UI í™•ì¸ |
| AC-6 | ìŠµë„ì™€ í’ì†ì´ í‘œì‹œëœë‹¤ | UI í™•ì¸ |
| AC-7 | ë‚ ì”¨ì— ë”°ë¼ ë°°ê²½ í…Œë§ˆê°€ ë³€ê²½ëœë‹¤ | UI í™•ì¸ |
| AC-8 | ë¡œë”© ì¤‘ ìŠ¤ì¼ˆë ˆí†¤ UIê°€ í‘œì‹œëœë‹¤ | UI í™•ì¸ |
| AC-9 | API ì˜¤ë¥˜ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ê°€ í‘œì‹œëœë‹¤ | ì—ëŸ¬ ì‹œë®¬ë ˆì´ì…˜ |
| AC-10 | 5ë¶„ ì´ë‚´ ì¬ìš”ì²­ ì‹œ ìºì‹œëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤ | ë„¤íŠ¸ì›Œí¬ íƒ­ í™•ì¸ |

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

```typescript
// services/weather/weatherService.test.ts
describe('weatherService', () => {
  describe('getCurrentWeather', () => {
    it('should return weather info for valid location', async () => {
      const location = { lat: 37.5665, lon: 126.9780 };
      const result = await weatherService.getCurrentWeather(location);
      
      expect(result.location.lat).toBe(location.lat);
      expect(result.current.temp).toBeDefined();
      expect(result.weather.main).toBeDefined();
    });

    it('should throw error for invalid location', async () => {
      const location = { lat: 999, lon: 999 };
      await expect(weatherService.getCurrentWeather(location)).rejects.toThrow();
    });
  });
});

describe('transformWeatherResponse', () => {
  it('should transform API response correctly', () => {
    const mockResponse = { /* mock data */ };
    const result = transformWeatherResponse(mockResponse);
    
    expect(result.current.temp).toBe(mockResponse.main.temp);
  });
});
```

### ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸

```typescript
// components/weather/WeatherCard.test.tsx
describe('WeatherCard', () => {
  it('renders weather information correctly', () => {
    const weather = mockWeatherInfo();
    render(<WeatherCard weather={weather} />);
    
    expect(screen.getByText(/22Â°C/)).toBeInTheDocument();
    expect(screen.getByText(/ë§‘ìŒ/)).toBeInTheDocument();
  });

  it('shows skeleton during loading', () => {
    render(<WeatherDisplay location={mockLocation} />);
    expect(screen.getByTestId('weather-skeleton')).toBeInTheDocument();
  });
});
```

---

## âš ï¸ ì—ëŸ¬ ì²˜ë¦¬

| ì—ëŸ¬ ìƒí™© | HTTP ì½”ë“œ | ì²˜ë¦¬ ë°©ë²• |
|----------|----------|----------|
| API í‚¤ ì˜¤ë¥˜ | 401 | ì½˜ì†” ì—ëŸ¬ ë¡œê¹…, ê¸°ë³¸ ì¶”ì²œìœ¼ë¡œ ì§„í–‰ |
| ìœ„ì¹˜ ì°¾ì„ ìˆ˜ ì—†ìŒ | 404 | "í•´ë‹¹ ìœ„ì¹˜ì˜ ë‚ ì”¨ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" í‘œì‹œ |
| ìš”ì²­ ì œí•œ ì´ˆê³¼ | 429 | "ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”" í‘œì‹œ |
| ì„œë²„ ì˜¤ë¥˜ | 500 | "ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" + ì¬ì‹œë„ ë²„íŠ¼ |
| ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ | - | "ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”" |

---

## ğŸ“Š ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­

| í•­ëª© | ëª©í‘œ |
|------|------|
| API ì‘ë‹µ ì‹œê°„ | 2ì´ˆ ì´ë‚´ |
| ìºì‹œ ìœ íš¨ ì‹œê°„ | 5ë¶„ |
| ì¬ì‹œë„ íšŸìˆ˜ | ìµœëŒ€ 2íšŒ |
| ë¡œë”© UI í‘œì‹œ | 200ms í›„ |

---

## ğŸ” ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

- [ ] API í‚¤ëŠ” í™˜ê²½ë³€ìˆ˜ë¡œ ê´€ë¦¬ (`VITE_OPENWEATHER_API_KEY`)
- [ ] í”„ë¡œë•ì…˜ì—ì„œëŠ” ë°±ì—”ë“œ í”„ë¡ì‹œë¥¼ í†µí•´ API í˜¸ì¶œ ê¶Œì¥
- [ ] ìš”ì²­ ë¡œê¹… ì‹œ API í‚¤ ë§ˆìŠ¤í‚¹

---

## ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© | ì‘ì„±ì |
|------|------|----------|--------|
| 1.0 | 2024-12-04 | ìµœì´ˆ ì‘ì„± | - |


